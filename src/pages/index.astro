---
  import { getUser } from "db/supabase/auth"
import Layout from "layouts/Layout.astro"
import Navigation from "components/Navigation"
import PostsList from "components/PostsList"

const user = await getUser(Astro.request)

console.log(user)

if (!user) {
  return Astro.redirect("/auth")
}

---


<Layout>
  <Navigation username={user.username} />
  <PostsList userId={user.id} client:load />
</Layout>
