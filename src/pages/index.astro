---
import PostsList from "../components/PostsList"
import Layout from "../layouts/Layout.astro"
import { getPosts } from "../db/prisma/queries"
import { getUser } from "../db/supabase/auth"
import Navigation from "../components/Navigation"

const user = await getUser(Astro.request)

console.log(user)

if (!user) {
  return Astro.redirect("/auth")
}

---


<Layout>
  <Navigation username={user.username} />
  <PostsList userId={user.id} client:load />
</Layout>
