---
import { getUser } from "db/supabase/auth"
import Layout from "layouts/Layout.astro"
import NewPost from "components/NewPost"

const user = await getUser(Astro.request)

if (!user) {
  return Astro.redirect("/auth")
}
---

<Layout user={user}>
  <NewPost userId={user.id} client:idle />
</Layout>
